/* SUMMARY: Global styles entry. Tailwind base/components/utilities + default
   design tokens using CSS variables. Themes override these variables. */
@import url('../themes/tokens.css');
@import url('../themes/eraThemes.css');

@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* Base design tokens (use RGB triplets where components expect rgb(var(--xxx))) */
  --background: 250 250 250;
  --surface: 250 250 250;
  --surface-2: 240 240 240;
  --text: 20 20 23;
  --text-muted: 90 90 100;
  --accent: 0 122 255;

  /* Layout tokens */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --radius: 12px;
  --shadow: 0 10px 30px rgba(0,0,0,0.12);

  --duration-fast: 120ms;
  --duration-slow: 320ms;
  --scrim-opacity: 0;
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: 16 16 16;
    --surface: 16 16 16;
    --surface-2: 28 28 28;
    --text: 235 235 235;
    --accent: 88 166 255;
  }
}

/* Theme classes applied by EraProvider. Provide both hex (for global chrome) and
   RGB triplets for components consuming either form. */
.theme-terminal {
  --bg: #0b0e10;
  --fg: #a8ff60;
  --chrome: #1a1f24;
  --accent-hex: #5eff00;

  --background: 11 14 16;
  --surface: 11 14 16;
  --surface-2: 26 31 36;
  --text: 168 255 96;
  --accent: 94 255 0;
}

.theme-os91 {
  --bg: #c3c7cb;
  --fg: #000000;
  --chrome: #e5e9f2;
  --accent-hex: #2a4b8d;

  --background: 195 199 203;
  --surface: 195 199 203;
  --surface-2: 229 233 242;
  --text: 0 0 0;
  --accent: 42 75 141;
}

.theme-now {
  --bg: #0b0d10;
  --fg: #e7eaf0;
  --chrome: #12161c;
  --accent-hex: #6ea8fe;

  --background: 11 13 16;
  --surface: 11 13 16;
  --surface-2: 18 22 28;
  --text: 231 234 240;
  --accent: 110 168 254;
}

.settings-grid { display: grid; grid-template-columns: 1fr; gap: 16px; }
.high-contrast { --text: 255 255 255; }
.reduced-motion * { transition: none !important; animation: none !important; }
body[data-reduce-motion="true"] * { transition: none !important; animation: none !important; }
.wallpaper-crt { --wallpaper: radial-gradient(100% 100% at 50% 50%, rgba(0,0,0,0.3), transparent), repeating-linear-gradient(0deg, rgba(0,0,0,0.15) 0px, rgba(0,0,0,0.15) 2px, transparent 2px, transparent 4px); }
.wallpaper-os91 { --wallpaper: linear-gradient(180deg, rgba(0,0,0,0.05), transparent), linear-gradient(135deg, rgba(0,0,0,0.06), transparent); }
.wallpaper-now { --wallpaper: conic-gradient(from 180deg at 50% 50%, rgba(0,0,0,0.08), transparent); }

html, body, #root { height: 100%; }
body { background: var(--wallpaper, rgb(var(--background))); color: rgb(var(--text)); }

/* Utilities for stubs/components */
.surface { background-color: rgb(var(--surface)); }
.text { color: rgb(var(--text)); }
.recents-list, .file-list { display: flex; flex-direction: column; gap: 6px; font-family: var(--mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace); }
.file-item, .recent-item { padding: 4px 8px; border-radius: 6px; cursor: pointer; }
.file-item:hover, .recent-item:hover { background: rgba(0,0,0,0.08); }

/* Window styles */
.window {
  width: min(80vw, 900px);
  background-color: rgb(var(--chrome, 255 255 255));
  border: 1px solid rgba(0,0,0,0.12);
  box-shadow: var(--shadow);
  border-radius: var(--radius);
  pointer-events: auto;
  display: flex;
  flex-direction: column;
  transform-origin: top left;
  transition: transform var(--duration-fast) ease, opacity var(--duration-fast) ease;
}

@media (prefers-reduced-motion: reduce) {
  .window { transition: none; }
}

.window-titlebar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 8px 12px;
  background: rgba(0,0,0,0.04);
  border-bottom: 1px solid rgba(0,0,0,0.06);
}

.window-title { font-weight: 600; font-size: 0.95rem; }
.window-controls { display: flex; gap: 8px; }
.window-btn { background: transparent; border: none; padding: 4px 6px; cursor: pointer; }
.window-btn:focus { outline: 2px solid rgb(var(--accent)); outline-offset: 2px; }

.window-content { padding: 12px; }

.window-active { box-shadow: 0 12px 40px rgba(0,0,0,0.25); }

/* Mobile specific */
.mobile-header { position: sticky; top: 0; backdrop-filter: blur(4px); }
.mobile-content { padding-bottom: env(safe-area-inset-bottom); }
.mobile-header .flex { padding-bottom: 0; }

/* Gesture-to-dismiss styles */
.mobile-gesture-root { position: relative; overflow: hidden; }
.mobile-gesture-card { will-change: transform; touch-action: pan-y; }
.mobile-gesture-scrim { pointer-events: none; position: absolute; inset: 0; background: rgba(0,0,0,0.0); transition: background 120ms linear; }

@media (prefers-reduced-motion: reduce) {
  .mobile-gesture-card { touch-action: auto; }
  .mobile-gesture-scrim { transition: none; }
}

/* App card/scrim (used for gesture-dismiss) */
.app-card {
  will-change: transform, opacity;
  background: var(--bg);
  color: var(--fg);
  box-shadow: 0 10px 30px rgba(0,0,0,0.25);
  border-radius: 12px;
}
.app-scrim {
  position: fixed; inset: 0;
  pointer-events: none;
  background: black;
  opacity: var(--scrim-opacity, 0);
  transition: opacity 120ms linear;
}
@media (prefers-reduced-motion: reduce) {
  .app-card, .app-scrim { transition: none !important; }
}

/* Countdown badge and reboot overlay */
.countdown-badge {
  position: fixed; left: 12px; bottom: 12px; z-index: 5000;
  background: var(--chrome); color: var(--fg);
  border: 1px solid rgba(0,0,0,0.12);
  padding: 6px 10px; border-radius: 999px; font-size: 12px;
  box-shadow: 0 6px 16px rgba(0,0,0,0.25);
}
.reboot-overlay {
  position: fixed; inset: 0; background: rgb(var(--background)); color: rgb(var(--text));
  display: grid; place-items: center; z-index: 9999;
  transition: opacity var(--duration-fast) ease;
}
@media (prefers-reduced-motion: reduce) {
  .countdown-badge, .reboot-overlay { transition: none !important; }
}



/* Desktop icon grid styles */
.desktop-icons { padding: 24px; }
.desktop-icon {
  --tile-bg: rgb(var(--surface-2));
  background: var(--tile-bg);
  border: 1px solid rgba(0,0,0,0.06);
  color: rgb(var(--text));
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
  cursor: pointer;
  width: 5rem;
  height: 5rem;
  border-radius: 8px;
}
.desktop-icon:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(var(--accent), 0.18);
  transform: translateY(-2px);
}
.desktop-icon:hover { transform: translateY(-1px); }

@media (prefers-reduced-motion: reduce) {
  .desktop-icon, .desktop-icon:focus { transform: none !important; }
}

/* Accessibility utilities */
.sr-only {
  position: absolute !important;
  height: 1px; width: 1px; overflow: hidden; clip: rect(1px, 1px, 1px, 1px);
  white-space: nowrap; border: 0; padding: 0; margin: -1px;
}

/* Focus-visible ring using CSS variables (no raw hex) */
:where(:focus):where(:not(:focus-visible)) { outline: none; }
:where(:focus-visible) { outline: 3px solid rgba(var(--accent), 0.22); outline-offset: 2px; }

/* Toast styles */
.toast-container { position: fixed; right: 12px; bottom: 12px; display: flex; flex-direction: column; gap: 8px; z-index: 6000; }
.toast {
  background: rgb(var(--surface-2)); color: rgb(var(--text)); border: 1px solid rgba(0,0,0,0.12);
  padding: 8px 12px; border-radius: 8px; box-shadow: 0 6px 16px rgba(0,0,0,0.2);
}

/* Terminal styles */
.terminal { font-family: var(--mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace); color: rgb(var(--text)); }
.terminal-screen { min-height: 200px; max-height: 50vh; overflow: auto; padding: 8px; background: rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.08); border-radius: 6px; }
.terminal-line { white-space: pre-wrap; line-height: 1.5; }
.terminal-input-row { display: flex; align-items: center; gap: 6px; margin-top: 8px; }
.terminal-prompt { color: rgb(var(--text-muted)); }
.terminal-input { flex: 1; background: transparent; border: 1px solid rgba(0,0,0,0.12); padding: 6px 8px; border-radius: 6px; color: rgb(var(--text)); caret-color: rgb(var(--accent)); }
.terminal-input:focus { outline: 2px solid rgb(var(--accent)); outline-offset: 2px; }

/* Arcade styles */
.arcade { display: flex; flex-direction: column; gap: 12px; }
.arcade-side { min-width: 12rem; }
.arcade-stage { flex: 1; display: flex; align-items: center; justify-content: center; }
.arcade-controls button { min-width: 44px; min-height: 44px; }

/* Mobile controls */
.mobile-controls { position: fixed; left: 0; right: 0; bottom: 12px; display: flex; justify-content: center; pointer-events: auto; }
.dpad { display: grid; grid-template-areas: 
  ". up ." 
  "left . right" 
  ". down ."; gap: 6px; }
.dpad button { width: 44px; height: 44px; border-radius: 6px; }
.actions { position: fixed; right: 12px; bottom: 80px; display:flex; flex-direction: column; gap:8px; }
.actions button { min-width: 48px; min-height: 48px; border-radius: 999px; }

/* Era-specific touch skins */
.theme-terminal .mobile-controls button { border: 1px solid rgb(var(--text)); background: transparent; color: rgb(var(--text)); }
.theme-os91 .mobile-controls button { background: rgb(var(--surface-2)); box-shadow: 0 2px 0 rgba(0,0,0,0.12); }
.theme-now .mobile-controls button { background: rgb(var(--surface)); box-shadow: 0 8px 20px rgba(0,0,0,0.12); }

/* Disable animated effects when reduced motion is requested */
body[data-reduce-motion="true"] .mobile-controls button { transition: none !important; }


